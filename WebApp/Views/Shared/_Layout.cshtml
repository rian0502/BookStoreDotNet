@{
    if (Session["isLogin"] == null)
    {
        Response.Redirect(Url.Action("Index", "Login"));
    }
}
<!DOCTYPE html>
<!--
This is a starter template page. Use this page to start your new project from
scratch. This page gets rid of all links and provides the needed markup only.
-->
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>First App</title>

    <!-- Google Font: Source Sans Pro -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="~/Content/plugins/fontawesome-free/css/all.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="~/Content/css/adminlte.min.css">
    <!-- Datatable -->
    <link rel="stylesheet" href="~/Content/plugins/datatables-bs4/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="~/Content/plugins/datatables-responsive/css/responsive.bootstrap4.min.css">
    <link rel="stylesheet" href="~/Content/plugins/datatables-buttons/css/buttons.bootstrap4.min.css">
    <!-- Select2 -->
    <link rel="stylesheet" href="~/Content/plugins/select2/css/select2.min.css">
    <link rel="stylesheet" href="~/Content/plugins/select2-bootstrap4-theme/select2-bootstrap4.min.css">
    <!-- Bootstrap4 Duallistbox -->
    <link rel="stylesheet" href="~/Content/plugins/bootstrap4-duallistbox/bootstrap-duallistbox.min.css">
    <!-- BS Stepper -->
    <link rel="stylesheet" href="~/Content/plugins/bs-stepper/css/bs-stepper.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.12.2/dist/sweetalert2.all.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.12.2/dist/sweetalert2.min.css" rel="stylesheet">
    <!-- Highchart -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>
</head>
<body class="hold-transition layout-top-nav">
    <div class="wrapper">

        <!-- Navbar -->
        <nav class="main-header navbar navbar-expand-md navbar-light navbar-white">
            <div class="container">
                <a href="@Url.Action("Index", "Home")" class="navbar-brand">
                    <img src="~/Content/img/AdminLTELogo.png" alt="AdminLTE Logo" class="brand-image img-circle elevation-3" style="opacity: .8">
                    <span class="brand-text font-weight-light">CRUDApp</span>
                </a>

                <div class="collapse navbar-collapse order-3" id="navbarCollapse">
                    <!-- Left navbar links -->
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a href="@Url.Action("Index", "Home")" class="nav-link @(ViewContext.RouteData.Values["Controller"].ToString() == "Home" && ViewContext.RouteData.Values["Action"].ToString() == "Index" ? "active" : "")">Home</a>
                        </li>
                        <li class="nav-item">
                            <a href="@Url.Action("Index", "Product")" class="nav-link @(ViewContext.RouteData.Values["Controller"].ToString() == "Product" && ViewContext.RouteData.Values["Action"].ToString() == "Index" ? "active" : "")">Products</a>
                        </li>
                        <li class="nav-item">
                            <a href="@Url.Action("Index", "KategoriBuku")" class="nav-link @(ViewContext.RouteData.Values["Controller"].ToString() == "KategoriBuku" && ViewContext.RouteData.Values["Action"].ToString() == "Index" ? "active" : "")">Kategori Buku</a>
                        </li>
                        <li class="nav-item">
                            <a href="@Url.Action("Index", "Buku")" class="nav-link @(ViewContext.RouteData.Values["Controller"].ToString() == "Buku" && ViewContext.RouteData.Values["Action"].ToString() == "Index" ? "active" : "")">Buku</a>
                        </li>
                        <li class="nav-item">
                            <a href="@Url.Action("Contact", "Home")" class="nav-link @(ViewContext.RouteData.Values["Controller"].ToString() == "Home" && ViewContext.RouteData.Values["Action"].ToString() == "Contact" ? "active" : "")">Contact</a>
                        </li>
                        <li class="nav-item">
                            <a href="@Url.Action("About", "Home")" class="nav-link @(ViewContext.RouteData.Values["Controller"].ToString() == "Home" && ViewContext.RouteData.Values["Action"].ToString() == "About" ? "active" : "")">About</a>
                        </li>
                    </ul>
                </div>

                <!-- Right navbar links -->
                <ul class="order-1 order-md-3 navbar-nav navbar-no-expand ml-auto">
                    <!-- Messages Dropdown Menu -->
                    <li class="nav-item dropdown">
                        <a class="nav-link" data-toggle="dropdown" href="#">
                            @Session["Name"]
                            <i class="fas fa-chevron-circle-down"></i>
                        </a>
                        <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">

                            <a href="" id="button_changepassword" class="dropdown-item">
                                <div class="row">
                                    <div class="col-1">
                                        <i class="fas fa-key"></i>
                                    </div>
                                    <div class="col-6">
                                        Ganti Password
                                    </div>

                                </div>
                            </a>
                            <div class="dropdown-divider"></div>
                            <a href="@Url.Action("Logout", "Login")" class="dropdown-item bg-danger">
                                <div class="row">
                                    <div class="col-1">
                                        <i class="fas fa-sign-out-alt"></i>
                                    </div>
                                    <div class="col-6">
                                        Logout
                                    </div>

                                </div>
                            </a>
                            <div class="dropdown-divider"></div>
                        </div>
                    </li>
                </ul>
            </div>
        </nav>
        <div class="modal fade" id="changePasswordModal" tabindex="-1" role="dialog" aria-labelledby="changePasswordModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="changePasswordModalLabel">Ganti Password</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <form id="changePasswordForm" method="post">
                            <div class="form-group">
                                <label for="newPassword">Password Baru</label>
                                <input type="password" class="form-control" id="newPassword">
                            </div>
                            <div class="form-group">
                                <label for="confirmPassword">Konfirmasi Password Baru</label>
                                <input type="password" class="form-control" id="confirmPassword">
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Tutup</button>
                        <button type="button" class="btn btn-primary" id="saveChanges">Simpan Perubahan</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="content-wrapper">
            <div class="content">
                <div class="container mt-5">
                    @RenderBody()
                </div>
            </div>
            <!-- /.content -->
        </div>
        <!-- /.content-wrapper -->
        <!-- Control Sidebar -->
        <aside class="control-sidebar control-sidebar-dark">
            <!-- Control sidebar content goes here -->
        </aside>
        <!-- /.control-sidebar -->
        <!-- Main Footer -->
        <footer class="main-footer">
            <!-- To the right -->
            <div class="float-right d-none d-sm-inline">
                Feel free
            </div>
            <!-- Default to the left -->
            <strong>Copyright &copy; 2024<a href="https://github.com/rian0502/BookStoreDotNet">Rian</a>.</strong> All rights reserved.
        </footer>
    </div>

    <!-- ./wrapper -->
    <!-- REQUIRED SCRIPTS -->
    <!-- jQuery -->
    <script src="~/Content/plugins/jquery/jquery.min.js"></script>
    <!-- Bootstrap 4 -->
    <script src="~/Content/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- AdminLTE App -->
    <script src="~/Content/js/adminlte.min.js"></script>
    <!-- datatable -->
    <script src="~/Content/plugins/datatables/jquery.dataTables.min.js"></script>
    <script src="~/Content/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js"></script>
    <script src="~/Content/plugins/datatables-responsive/js/dataTables.responsive.min.js"></script>
    <script src="~/Content/plugins/datatables-responsive/js/responsive.bootstrap4.min.js"></script>
    <script src="~/Content/plugins/datatables-buttons/js/dataTables.buttons.min.js"></script>
    <script src="~/Content/plugins/datatables-buttons/js/buttons.bootstrap4.min.js"></script>
    <script src="~/Content/plugins/jszip/jszip.min.js"></script>
    <script src="~/Content/plugins/pdfmake/pdfmake.min.js"></script>
    <script src="~/Content/plugins/pdfmake/vfs_fonts.js"></script>
    <script src="~/Content/plugins/datatables-buttons/js/buttons.html5.min.js"></script>
    <script src="~/Content/plugins/datatables-buttons/js/buttons.print.min.js"></script>
    <script src="~/Content/plugins/datatables-buttons/js/buttons.colVis.min.js"></script>
    <script src="~/Content/plugins/select2/js/select2.full.min.js"></script>
    <!-- Bootstrap4 Duallistbox -->
    <script src="~/Content/plugins/bootstrap4-duallistbox/jquery.bootstrap-duallistbox.min.js"></script>


    <script>
        $(function () {
            $('.select2').select2()
            $('.select2bs4').select2({
                theme: 'bootstrap4'
            })
            $("#example1").DataTable({
                "responsive": true, "lengthChange": false, "autoWidth": false,

            }).buttons().container().appendTo('#example1_wrapper .col-md-6:eq(0)');
            $('#example2').DataTable({
                "paging": true,
                "lengthChange": false,
                "searching": false,
                "ordering": true,
                "info": true,
                "autoWidth": false,
                "responsive": true,
            });
        });
    </script>
    <script>
    $(document).ready(function () {
        var successMessage = "@(TempData["success"] ?? "")";
        var errorMessage = "@(TempData["error"] ?? "")";

        if (successMessage) {
            Swal.fire({
                icon: 'success',
                title: 'Success!',
                text: successMessage,
                showConfirmButton: false,
                timer: 2000
            });
        }

        if (errorMessage) {
            Swal.fire({
                icon: 'error',
                title: 'Error!',
                text: errorMessage,
                showConfirmButton: false,
                timer: 2000
            });
        }
    });
    </script>
    <script>
        $(document).ready(function () {
            $('#button_changepassword').click(function (e) {
                e.preventDefault();
                $('#changePasswordModal').modal('show');
            });

            $('#saveChanges').click(function (e) {
                e.preventDefault();
                var newPassword = $('#newPassword').val();
                var confirmPassword = $('#confirmPassword').val();

                if (newPassword !== confirmPassword) {
                    Swal.fire({
                        icon: 'error',
                        title: 'Error!',
                        text: 'Password baru dan konfirmasi password tidak sama',
                        showConfirmButton: false,
                        timer: 2000
                    });
                } else {
                    $.ajax({
                        type: 'POST',
                        url: '@Url.Action("ChangePassword", "Login")',
                        data: {
                            newPassword: newPassword
                        },
                        success: function (response) {
                            if (response.success) {
                                Swal.fire({
                                    icon: 'success',
                                    title: 'Success!',
                                    text: response.message,
                                    showConfirmButton: false,
                                    timer: 2000
                                });
                                $('#changePasswordModal').modal('hide');
                            } else {
                                Swal.fire({
                                    icon: 'error',
                                    title: 'Error!',
                                    text: response.message,
                                    showConfirmButton: false,
                                    timer: 2000
                                });
                            }
                        },
                        error: function () {
                            Swal.fire({
                                icon: 'error',
                                title: 'Error!',
                                text: 'Terjadi kesalahan saat memproses permintaan',
                                showConfirmButton: false,
                                timer: 2000
                            });
                        }
                    });
                }
            });
            $(document).ready(function () {
                $(".delete-form").on("submit", function (event) {
                    event.preventDefault();
                    var form = $(this);
                    Swal.fire({
                        title: 'Apakah Anda yakin ingin menghapus data ini?',
                        text: "Data yang dihapus tidak bisa dikembalikan!",
                        icon: 'warning',
                        showCancelButton: true,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Ya, hapus!',
                        cancelButtonText: 'Batal'
                    }).then((result) => {
                        if (result.isConfirmed) {
                            form.off("submit").submit();
                        }
                    });
                });
            });
        });
    </script>
    <script>
        $(document).ready(function () {
            $.ajax({
                url: '@Url.Action("GetPenggunaanKategori", "Home")',
                type: 'GET',
                dataType: 'json',
                success: function (result) {
                    if (result.success) {
                        const categories = [];
                        const data = [];
                        $.each(result.data, function (index, item) {
                            categories.push(item.Kategori);
                            data.push({
                                name: item.Kategori,
                                y: item.Total
                            });
                        });
                        Highcharts.chart('chartKategoriBuku', {
                            chart: {
                                type: 'pie'
                            },
                            title: {
                                text: 'Penggunaan Kategori Buku'
                            },
                            tooltip: {
                                pointFormat: '<b>{point.name}: {point.y}</b>'
                            },
                            series: [{
                                name: 'Total Buku',
                                data: data
                            }]
                        });
                    } else {
                        Swal.fire({
                            icon: 'error',
                            title: 'Error!',
                            text: 'Terjadi kesalahan saat memproses permintaan',
                            showConfirmButton: false,
                            timer: 2000
                        });
                    }
                },
                error: function (xhr, status, error) {
                    Swal.fire({
                        icon: 'error',
                        title: 'Error!',
                        text: error,
                        showConfirmButton: false,
                        timer: 5000
                    });
                }
            });
        });
    </script>
    <script>
        $(document).ready(function () {
            $.ajax({
                url: '@Url.Action("GetProduct", "Home")',
                type: 'GET',
                dataType: 'json',
                success: function (result) {
                    if (result.success) {
                        const categories = [];
                        const harga = [];
                        console.log(result.data);
                        $.each(result.data, function (index, item) {
                            categories.push(item.Name);
                            harga.push(item.Price);
                        });

                        Highcharts.chart('chartHargaProduct', {
                            chart: {
                                type: 'column'
                            },
                            title: {
                                text: 'Harga Produk'
                            },
                            xAxis: {
                                categories: categories,
                                title: {
                                    text: 'Nama Produk'
                                }
                            },
                            yAxis: {
                                min: 0,
                                title: {
                                    text: 'Harga (USD)'
                                },
                                allowDecimals: false
                            },
                            tooltip: {
                                headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                                pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                                    '<td style="padding:0"><b>{point.y:.1f}</b></td></tr>',
                                footerFormat: '</table>',
                                shared: true,
                                useHTML: true
                            },
                            plotOptions: {
                                column: {
                                    pointPadding: 0.2,
                                    borderWidth: 0
                                }
                            },
                            series: [{
                                name: 'Harga',
                                data: harga
                            }]
                        });
                    } else {
                        Swal.fire({
                            icon: 'error',
                            title: 'Error!',
                            text: 'Terjadi kesalahan saat memproses permintaan',
                            showConfirmButton: false,
                            timer: 2000
                        });
                    }
                },
                error: function (xhr, status, error) {
                    Swal.fire({
                        icon: 'error',
                        title: 'Error!',
                        text: error,
                        showConfirmButton: false,
                        timer: 5000
                    });
                }
            });
        });
    </script>
</body>
</html>